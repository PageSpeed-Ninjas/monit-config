check process ossec-analysisd matching "ossec-analysisd"
    group security
    group nids
    group ossec
    start program   "/etc/init.d/ossec start"
    restart program "/etc/init.d/ossec restart"
    stop  program   "/etc/init.d/ossec stop"
    if 5 restarts within 5 cycles then timeout
    depends on ossec_rc

check process ossec-execd matching "ossec-execd"
    group security
    group nids
    group ossec
    start program   "/etc/init.d/ossec start"
    restart program "/etc/init.d/ossec restart"
    stop  program   "/etc/init.d/ossec stop"
    if 5 restarts within 5 cycles then timeout
    depends on ossec_rc

check process ossec-logcollec matching "ossec-logcollec"
    group security
    group nids
    group ossec
    start program   "/etc/init.d/ossec start"
    restart program "/etc/init.d/ossec restart"
    stop  program   "/etc/init.d/ossec stop"
    if 5 restarts within 5 cycles then timeout
    depends on ossec_rc

check process ossec-maild matching "ossec-maild"
    group security
    group nids
    group ossec
    start program   "/etc/init.d/ossec start"
    restart program "/etc/init.d/ossec restart"
    stop  program   "/etc/init.d/ossec stop"
    if 5 restarts within 5 cycles then timeout
    depends on ossec_rc

check process ossec-monitord matching "ossec-monitord"
    group security
    group nids
    group ossec
    start program   "/etc/init.d/ossec start"
    restart program "/etc/init.d/ossec restart"
    stop  program   "/etc/init.d/ossec stop"
    if 5 restarts within 5 cycles then timeout
    depends on ossec_rc

check process ossec-remoted matching "ossec-remoted"
    group security
    group nids
    group ossec
    start program   "/etc/init.d/ossec start"
    restart program "/etc/init.d/ossec restart"
    stop  program   "/etc/init.d/ossec stop"
    if 5 restarts within 5 cycles then timeout
    depends on ossec_rc

check process ossec-syscheckd matching "ossec-syscheckd"
    group security
    group nids
    group ossec
    start program   "/etc/init.d/ossec start"
    restart program "/etc/init.d/ossec restart"
    stop  program   "/etc/init.d/ossec stop"
    if 5 restarts within 5 cycles then timeout
    depends on ossec_rc

check file ossec_rc with path /etc/init.d/ossec
    group security
    group nids
    group ossec
    if failed checksum then unmonitor
    if failed permission 0555 then unmonitor
    if failed uid root then unmonitor
    if failed gid ossec then unmonitor
